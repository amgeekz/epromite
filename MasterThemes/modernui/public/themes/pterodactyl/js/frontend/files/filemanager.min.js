'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var ActionsClass=function(){function ActionsClass(element,menu){_classCallCheck(this,ActionsClass);this.element=element;this.menu=menu}_createClass(ActionsClass,[{key:'destroy',value:function destroy(){this.element=undefined}},{key:'sanitizedString',value:function sanitizedString(value){return $('<div>').text(value).html()}},{key:'folder',value:function folder(path){var inputValue=void 0;if(path){inputValue=path}else{var nameBlock=$(this.element).find('td[data-identifier="name"]');var currentName=decodeURIComponent(nameBlock.data('name'));var currentPath=decodeURIComponent(nameBlock.data('path'));if($(this.element).data('type')==='file'){inputValue=currentPath}else{inputValue=''+currentPath+currentName+'/'}}swal({type:'input',title:'Create Folder',text:'Please enter the path and folder name below.',showCancelButton:true,showConfirmButton:true,closeOnConfirm:false,showLoaderOnConfirm:true,inputValue:inputValue},function(val){if(val===false){return false}$.ajax({type:'POST',headers:{'X-Access-Token':Pterodactyl.server.daemonSecret,'X-Access-Server':Pterodactyl.server.uuid},contentType:'application/json; charset=utf-8',url:Pterodactyl.node.scheme+'://'+Pterodactyl.node.fqdn+':'+Pterodactyl.node.daemonListen+'/v1/server/file/folder',timeout:10000,data:JSON.stringify({path:val})}).done(function(data){swal.close();Files.list()}).fail(function(jqXHR){console.error(jqXHR);var error='An error occurred while trying to process this request.';if(typeof jqXHR.responseJSON!=='undefined'&&typeof jqXHR.responseJSON.error!=='undefined'){error=jqXHR.responseJSON.error}swal({type:'error',title:'',text:error})})})}},{key:'move',value:function move(){var nameBlock=$(this.element).find('td[data-identifier="name"]');var currentName=decodeURIComponent(nameBlock.attr('data-name'));var currentPath=decodeURIComponent(nameBlock.data('path'));swal({type:'input',title:'Move File',text:'Please enter the new path for the file below.',showCancelButton:true,showConfirmButton:true,closeOnConfirm:false,showLoaderOnConfirm:true,inputValue:''+currentPath+currentName},function(val){if(val===false){return false}$.ajax({type:'POST',headers:{'X-Access-Token':Pterodactyl.server.daemonSecret,'X-Access-Server':Pterodactyl.server.uuid},contentType:'application/json; charset=utf-8',url:Pterodactyl.node.scheme+'://'+Pterodactyl.node.fqdn+':'+Pterodactyl.node.daemonListen+'/v1/server/file/move',timeout:10000,data:JSON.stringify({from:''+currentPath+currentName,to:''+val})}).done(function(data){nameBlock.parent().addClass('warning').delay(200).fadeOut();swal.close()}).fail(function(jqXHR){console.error(jqXHR);var error='An error occurred while trying to process this request.';if(typeof jqXHR.responseJSON!=='undefined'&&typeof jqXHR.responseJSON.error!=='undefined'){error=jqXHR.responseJSON.error}swal({type:'error',title:'',text:error})})})}},{key:'rename',value:function rename(){var nameBlock=$(this.element).find('td[data-identifier="name"]');var currentLink=nameBlock.find('a');var currentName=decodeURIComponent(nameBlock.attr('data-name'));var attachEditor='\n            <input class="form-control input-sm" type="text" value="'+currentName+'" />\n            <span class="input-loader"><i class="fa fa-refresh fa-spin fa-fw"></i></span>\n        ';nameBlock.html(attachEditor);var inputField=nameBlock.find('input');var inputLoader=nameBlock.find('.input-loader');inputField.focus();inputField.on('blur keydown',function(e){if(e.type==='keydown'&&e.which===27||e.type==='blur'||e.type==='keydown'&&e.which===13&&currentName===inputField.val()){if(!_.isEmpty(currentLink)){nameBlock.html(currentLink)}else{nameBlock.html(currentName)}inputField.remove();ContextMenu.unbind().run();return}if(e.type==='keydown'&&e.which!==13)return;inputLoader.show();var currentPath=decodeURIComponent(nameBlock.data('path'));$.ajax({type:'POST',headers:{'X-Access-Token':Pterodactyl.server.daemonSecret,'X-Access-Server':Pterodactyl.server.uuid},contentType:'application/json; charset=utf-8',url:Pterodactyl.node.scheme+'://'+Pterodactyl.node.fqdn+':'+Pterodactyl.node.daemonListen+'/v1/server/file/rename',timeout:10000,data:JSON.stringify({from:''+currentPath+currentName,to:''+currentPath+inputField.val()})}).done(function(data){nameBlock.attr('data-name',inputField.val());if(!_.isEmpty(currentLink)){var newLink=currentLink.attr('href');if(nameBlock.parent().data('type')!=='folder'){newLink=newLink.substr(0,newLink.lastIndexOf('/'))+'/'+inputField.val()}currentLink.attr('href',newLink);nameBlock.html(currentLink.html(inputField.val()))}else{nameBlock.html(inputField.val())}inputField.remove()}).fail(function(jqXHR){console.error(jqXHR);var error='An error occurred while trying to process this request.';if(typeof jqXHR.responseJSON!=='undefined'&&typeof jqXHR.responseJSON.error!=='undefined'){error=jqXHR.responseJSON.error}nameBlock.addClass('has-error').delay(2000).queue(function(){nameBlock.removeClass('has-error').dequeue()});inputField.popover({animation:true,placement:'top',content:error,title:'Save Error'}).popover('show')}).always(function(){inputLoader.remove();ContextMenu.unbind().run()})})}},{key:'copy',value:function copy(){var nameBlock=$(this.element).find('td[data-identifier="name"]');var currentName=decodeURIComponent(nameBlock.attr('data-name'));var currentPath=decodeURIComponent(nameBlock.data('path'));swal({type:'input',title:'Copy File',text:'Please enter the new path for the copied file below.',showCancelButton:true,showConfirmButton:true,closeOnConfirm:false,showLoaderOnConfirm:true,inputValue:''+currentPath+currentName},function(val){if(val===false){return false}$.ajax({type:'POST',headers:{'X-Access-Token':Pterodactyl.server.daemonSecret,'X-Access-Server':Pterodactyl.server.uuid},contentType:'application/json; charset=utf-8',url:Pterodactyl.node.scheme+'://'+Pterodactyl.node.fqdn+':'+Pterodactyl.node.daemonListen+'/v1/server/file/copy',timeout:10000,data:JSON.stringify({from:''+currentPath+currentName,to:''+val})}).done(function(data){swal({type:'success',title:'',text:'File successfully copied.'});Files.list()}).fail(function(jqXHR){console.error(jqXHR);var error='An error occurred while trying to process this request.';if(typeof jqXHR.responseJSON!=='undefined'&&typeof jqXHR.responseJSON.error!=='undefined'){error=jqXHR.responseJSON.error}swal({type:'error',title:'',text:error})})})}},{key:'download',value:function download(){var nameBlock=$(this.element).find('td[data-identifier="name"]');var fileName=decodeURIComponent(nameBlock.attr('data-name'));var filePath=decodeURIComponent(nameBlock.data('path'));window.location='/server/'+Pterodactyl.server.uuidShort+'/files/download/'+filePath+fileName}},{key:'delete',value:function _delete(){var nameBlock=$(this.element).find('td[data-identifier="name"]');var delPath=decodeURIComponent(nameBlock.data('path'));var delName=decodeURIComponent(nameBlock.data('name'));swal({type:'warning',title:'',text:'Are you sure you want to delete <code>'+this.sanitizedString(delName)+'</code>?',html:true,showCancelButton:true,showConfirmButton:true,closeOnConfirm:false,showLoaderOnConfirm:true},function(){$.ajax({type:'POST',headers:{'X-Access-Token':Pterodactyl.server.daemonSecret,'X-Access-Server':Pterodactyl.server.uuid},contentType:'application/json; charset=utf-8',url:Pterodactyl.node.scheme+'://'+Pterodactyl.node.fqdn+':'+Pterodactyl.node.daemonListen+'/v1/server/file/delete',timeout:10000,data:JSON.stringify({items:[''+delPath+delName]})}).done(function(data){nameBlock.parent().addClass('warning').delay(200).fadeOut();swal({type:'success',title:'File Deleted'})}).fail(function(jqXHR){console.error(jqXHR);swal({type:'error',title:'Whoops!',html:true,text:'An error occurred while attempting to delete this file. Please try again.'})})})}},{key:'toggleMassActions',value:function toggleMassActions(){if($('#file_listing input[type="checkbox"]:checked').length){$('#mass_actions').removeClass('disabled')}else{$('#mass_actions').addClass('disabled')}}},{key:'toggleHighlight',value:function toggleHighlight(event){var parent=$(event.currentTarget);var item=$(event.currentTarget).find('input');if($(item).is(':checked')){$(item).prop('checked',false);parent.removeClass('warning').delay(200)}else{$(item).prop('checked',true);parent.addClass('warning').delay(200)}}},{key:'highlightAll',value:function highlightAll(event){var parent=void 0;var item=$(event.currentTarget).find('input');if($(item).is(':checked')){$('#file_listing input[type=checkbox]').prop('checked',false);$('#file_listing input[data-action="addSelection"]').each(function(){parent=$(this).closest('tr');parent.removeClass('warning').delay(200)})}else{$('#file_listing input[type=checkbox]').prop('checked',true);$('#file_listing input[data-action="addSelection"]').each(function(){parent=$(this).closest('tr');parent.addClass('warning').delay(200)})}}},{key:'deleteSelected',value:function deleteSelected(){var selectedItems=[];var selectedItemsElements=[];var parent=void 0;var nameBlock=void 0;var delLocation=void 0;$('#file_listing input[data-action="addSelection"]:checked').each(function(){parent=$(this).closest('tr');nameBlock=$(parent).find('td[data-identifier="name"]');delLocation=decodeURIComponent(nameBlock.data('path'))+decodeURIComponent(nameBlock.data('name'));selectedItems.push(delLocation);selectedItemsElements.push(parent)});if(selectedItems.length!=0){var formattedItems='';var i=0;var self=this;$.each(selectedItems,function(key,value){formattedItems+='<code>'+self.sanitizedString(value)+'</code>, ';i++;return i<5});formattedItems=formattedItems.slice(0,-2);if(selectedItems.length>5){formattedItems+=', and '+(selectedItems.length-5)+' other(s)'}swal({type:'warning',title:'',text:'Are you sure you want to delete the following files: '+formattedItems+'?',html:true,showCancelButton:true,showConfirmButton:true,closeOnConfirm:false,showLoaderOnConfirm:true},function(){$.ajax({type:'POST',headers:{'X-Access-Token':Pterodactyl.server.daemonSecret,'X-Access-Server':Pterodactyl.server.uuid},contentType:'application/json; charset=utf-8',url:Pterodactyl.node.scheme+'://'+Pterodactyl.node.fqdn+':'+Pterodactyl.node.daemonListen+'/v1/server/file/delete',timeout:10000,data:JSON.stringify({items:selectedItems})}).done(function(data){$('#file_listing input:checked').each(function(){$(this).prop('checked',false)});$.each(selectedItemsElements,function(){$(this).addClass('warning').delay(200).fadeOut()});swal({type:'success',title:'Files Deleted'})}).fail(function(jqXHR){console.error(jqXHR);swal({type:'error',title:'Whoops!',html:true,text:'An error occurred while attempting to delete these files. Please try again.'})})})}else{swal({type:'warning',title:'',text:'Please select files/folders to delete.'})}}},{key:'decompress',value:function decompress(){var nameBlock=$(this.element).find('td[data-identifier="name"]');var compPath=decodeURIComponent(nameBlock.data('path'));var compName=decodeURIComponent(nameBlock.data('name'));swal({title:'<i class="fa fa-refresh fa-spin"></i> Decompressing...',text:'This might take a few seconds to complete.',html:true,allowOutsideClick:false,allowEscapeKey:false,showConfirmButton:false});$.ajax({type:'POST',url:Pterodactyl.node.scheme+'://'+Pterodactyl.node.fqdn+':'+Pterodactyl.node.daemonListen+'/v1/server/file/decompress',headers:{'X-Access-Token':Pterodactyl.server.daemonSecret,'X-Access-Server':Pterodactyl.server.uuid},contentType:'application/json; charset=utf-8',data:JSON.stringify({files:''+compPath+compName})}).done(function(data){swal.close();Files.list(compPath)}).fail(function(jqXHR){console.error(jqXHR);var error='An error occurred while trying to process this request.';if(typeof jqXHR.responseJSON!=='undefined'&&typeof jqXHR.responseJSON.error!=='undefined'){error=jqXHR.responseJSON.error}swal({type:'error',title:'Whoops!',html:true,text:error})})}},{key:'compress',value:function compress(){var _this=this;var nameBlock=$(this.element).find('td[data-identifier="name"]');var compPath=decodeURIComponent(nameBlock.data('path'));var compName=decodeURIComponent(nameBlock.data('name'));$.ajax({type:'POST',url:Pterodactyl.node.scheme+'://'+Pterodactyl.node.fqdn+':'+Pterodactyl.node.daemonListen+'/v1/server/file/compress',headers:{'X-Access-Token':Pterodactyl.server.daemonSecret,'X-Access-Server':Pterodactyl.server.uuid},contentType:'application/json; charset=utf-8',data:JSON.stringify({files:''+compPath+compName,to:compPath.toString()})}).done(function(data){Files.list(compPath,function(err){if(err)return;var fileListing=$('#file_listing').find('[data-name="'+data.saved_as+'"]').parent();fileListing.addClass('success pulsate').delay(3000).queue(function(){fileListing.removeClass('success pulsate').dequeue()})})}).fail(function(jqXHR){console.error(jqXHR);var error='An error occurred while trying to process this request.';if(typeof jqXHR.responseJSON!=='undefined'&&typeof jqXHR.responseJSON.error!=='undefined'){error=jqXHR.responseJSON.error}swal({type:'error',title:'Whoops!',html:true,text:_this.sanitizedString(error)})})}}]);return ActionsClass}();
"use strict";class ContextMenuClass{constructor(){this.activeLine=null}run(){this.directoryClick(),this.rightClick()}makeMenu(t){$(document).find("#fileOptionMenu").remove(),_.isNull(this.activeLine)||this.activeLine.removeClass("active");let e=$("#file_listing").data("current-dir");if("folder"===t.data("type")){const a=t.find('td[data-identifier="name"]'),o=decodeURIComponent(a.attr("data-name"));e=`${decodeURIComponent(a.data("path"))}${o}`}let a="";return Pterodactyl.permissions.moveFiles&&(a+='<div class="btn-group">                          <button class="btn btn-success btn-sm" data-action="rename"><a class="text-white" tabindex="-1" href="#"><i class="fa fa-fw fa-pencil-square-o"></i> Rename</a></button>                           <button class="btn btn-warning btn-sm" data-action="move"><a class="text-white" tabindex="-1" href="#"><i class="fa fa-fw fa-arrow-right"></i> Move</a></button>                          </div><hr>'),Pterodactyl.permissions.copyFiles&&(a+='<button class="btn btn-info btn-sm" data-action="copy"><a class="text-white" tabindex="-1" href="#"><i class="fa fa-fw fa-clone"></i> Copy</a></button><hr>'),(Pterodactyl.permissions.compressFiles||Pterodactyl.permissions.decompressFiles)&&(a+='<div class="btn-group compressActions" style="display: none;">'),Pterodactyl.permissions.compressFiles&&(a+='<button data-action="compress" class="btn btn-warning btn-sm" style="display: none;"><a class="text-white" tabindex="-1" href="#"><i class="fa fa-fw fa-file-archive-o"></i> Compress</a></button>'),Pterodactyl.permissions.decompressFiles&&(a+='<button data-action="decompress" class="btn btn-primary btn-sm" style="display: none;"><a class="text-white" tabindex="-1" href="#"><i class="fa fa-fw fa-expand"></i> Decompress</a></button>'),(Pterodactyl.permissions.compressFiles||Pterodactyl.permissions.decompressFiles)&&(a+='</div><hr class="compressActions" style="display: none;">'),Pterodactyl.permissions.createFiles&&(a+='<div class="btn-group">         <button class="btn btn-sm btn-primary" data-action="file"><a class="text-white" href="/server/'+Pterodactyl.server.uuidShort+"/files/add/?dir="+$("<div>").text(e).html()+'" class="text-muted"><i class="fa fa-fw fa-plus"></i> New File</a></button>                           <button class="btn btn-sm btn-info" data-action="folder" onclick="$(\'#actionsModal\').modal(\'hide\');"><a class="text-white" tabindex="-1" href="#"><i class="fa fa-fw fa-folder"></i> New Folder</a></button>                          </div><hr>'),(Pterodactyl.permissions.downloadFiles||Pterodactyl.permissions.deleteFiles)&&(a+='<div class="btn-group">'),Pterodactyl.permissions.downloadFiles&&(a+='<button data-action="download" class="btn btn-sm btn-success" style="display: none;"><a tabindex="-1" href="#" class="text-white"><i class="fa fa-fw fa-download"></i> Download</a></button>'),Pterodactyl.permissions.deleteFiles&&(a+='<button data-action="delete" class="bg-danger btn btn-sm btn-danger"><a tabindex="-1" href="#" class="text-white"><i class="fa fa-fw fa-trash-o"></i> Delete</a></button>'),(Pterodactyl.permissions.downloadFiles||Pterodactyl.permissions.deleteFiles)&&(a+="</div>"),a}rightClick(){$('[data-action="toggleMenu"]').on("mousedown",t=>{t.preventDefault(),$(document).find("#fileOptionMenu").is(":visible")?$("body").trigger("click"):this.showMenu(t)}),$("#file_listing > tbody td").on("contextmenu",t=>{this.showMenu(t)})}showMenu(t){const e=$(t.target).closest("tr"),a=$(this.makeMenu(e));if("disabled"===e.data("type"))return;t.preventDefault(),$("#actionsModalBody").html(a),$("#actionsModal").modal("show"),this.activeLine=e,this.activeLine.addClass("active");const o=new ActionsClass(e,a);Pterodactyl.permissions.moveFiles&&($("#actionsModalBody").find('button[data-action="move"]').unbind().on("click",t=>{t.preventDefault(),$("#actionsModal").modal("hide"),o.move()}),$("#actionsModalBody").find('button[data-action="rename"]').unbind().on("click",t=>{t.preventDefault(),$("#actionsModal").modal("hide"),o.rename()})),Pterodactyl.permissions.copyFiles&&$("#actionsModalBody").find('button[data-action="copy"]').unbind().on("click",t=>{t.preventDefault(),$("#actionsModal").modal("hide"),o.copy()}),Pterodactyl.permissions.compressFiles&&("folder"===e.data("type")&&($("#actionsModalBody").find('button[data-action="compress"]').show(),$("#actionsModalBody").find(".compressActions").show()),$("#actionsModalBody").find('button[data-action="compress"]').unbind().on("click",t=>{t.preventDefault(),$("#actionsModal").modal("hide"),o.compress()})),Pterodactyl.permissions.decompressFiles&&(_.without(["application/zip","application/gzip","application/x-gzip"],e.data("mime")).length<3&&($("#actionsModalBody").find('button[data-action="decompress"]').show(),$("#actionsModalBody").find(".compressActions").show()),$("#actionsModalBody").find('button[data-action="decompress"]').unbind().on("click",t=>{t.preventDefault(),$("#actionsModal").modal("hide"),o.decompress()})),Pterodactyl.permissions.createFiles&&$("#actionsModalBody").find('button[data-action="folder"]').unbind().on("click",t=>{t.preventDefault(),o.folder()}),Pterodactyl.permissions.downloadFiles&&("file"===e.data("type")&&$("#actionsModalBody").find('button[data-action="download"]').show(),$("#actionsModalBody").find('button[data-action="download"]').unbind().on("click",t=>{t.preventDefault(),$("#actionsModal").modal("hide"),o.download()})),Pterodactyl.permissions.deleteFiles&&$("#actionsModalBody").find('button[data-action="delete"]').unbind().on("click",t=>{t.preventDefault(),$("#actionsModal").modal("hide"),o.delete()})}directoryClick(){$('a[data-action="directory-view"]').on("click",function(t){t.preventDefault();const e=$(this).parent().data("path")||"",a=$(this).parent().data("name")||"";window.location.hash=encodeURIComponent(e+a),Files.list()})}}window.ContextMenu=new ContextMenuClass;
'use strict';var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var FileManager=function(){function FileManager(){_classCallCheck(this,FileManager);this.list(this.decodeHash())}_createClass(FileManager,[{key:'list',value:function list(path,next){var _this=this;if(_.isUndefined(path)){path=this.decodeHash()}this.loader(true);$.ajax({type:'POST',url:Pterodactyl.meta.directoryList,headers:{'X-CSRF-Token':Pterodactyl.meta.csrftoken},data:{directory:path}}).done(function(data){_this.loader(false);$('#load_files').slideUp(10).html(data).slideDown(10,function(){ContextMenu.run();_this.reloadFilesButton();_this.addFolderButton();_this.selectItem();_this.selectAll();_this.selectiveDeletion();_this.selectRow();if(_.isFunction(next)){return next()}});$('#internal_alert').slideUp();if((typeof Siofu==='undefined'?'undefined':_typeof(Siofu))==='object'){Siofu.listenOnInput(document.getElementById('files_touch_target'))}}).fail(function(jqXHR){_this.loader(false);if(_.isFunction(next)){return next(new Error('Failed to load file listing.'))}if(path!==''&&path!=='/'&&jqXHR.status===404){return _this.list('',next)}swal({type:'error',title:'File Error',text:jqXHR.responseJSON.errors[0].detail||'An error occurred while attempting to process this request. Please try again.'});console.error(jqXHR)})}},{key:'loader',value:function loader(show){if(show){$('.file-overlay').fadeIn(100)}else{$('.file-overlay').fadeOut(100)}}},{key:'reloadFilesButton',value:function reloadFilesButton(){var _this2=this;$('i[data-action="reload-files"]').unbind().on('click',function(){$('i[data-action="reload-files"]').addClass('fa-spin');_this2.list()})}},{key:'selectItem',value:function selectItem(){$('[data-action="addSelection"]').on('click',function(event){event.preventDefault()})}},{key:'selectAll',value:function selectAll(){$('[data-action="selectAll"]').on('click',function(event){event.preventDefault()})}},{key:'selectiveDeletion',value:function selectiveDeletion(){$('[data-action="selective-deletion"]').on('mousedown',function(event){new ActionsClass().deleteSelected()})}},{key:'addFolderButton',value:function addFolderButton(){$('[data-action="add-folder"]').unbind().on('click',function(){new ActionsClass().folder($('#file_listing').data('current-dir')||'/')})}},{key:'selectRow',value:function selectRow(){$('#file_listing tr').on('mousedown',function(event){if(event.which===1){if($(event.target).is('th')||$(event.target).is('input[data-action="selectAll"]')){new ActionsClass().highlightAll(event)}else if($(event.target).is('td')||$(event.target).is('input[data-action="addSelection"]')){new ActionsClass().toggleHighlight(event)}new ActionsClass().toggleMassActions()}})}},{key:'decodeHash',value:function decodeHash(){return decodeURIComponent(window.location.hash.substring(1))}}]);return FileManager}();window.Files=new FileManager;

//# sourceMappingURL=filemanager.min.js.map
